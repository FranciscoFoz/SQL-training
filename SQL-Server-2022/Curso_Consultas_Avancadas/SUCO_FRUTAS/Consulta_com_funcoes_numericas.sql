-- CONSULTA COM FUNÇÕES NUMÉRICAS

SELECT 
11.12345689 AS NUMERO,
ROUND(11.12345689, 3) AS ROUND,
CEILING(11.12345689) AS CEILING,
FLOOR(11.12345689) AS FL0OR,
POWER(11.12345689,2) AS POTENCIA_DE_2,
SQRT(11.12345689) AS RAIZ_QUADRADA;

-- EXERCICIO
-- Na tabela de notas fiscais, temos o valor do imposto. 
-- Já na tabela de itens, temos a quantidade e o faturamento. 
-- Calcule o valor do imposto pago no ano de 2016, arredondando para o menor inteiro.

SELECT * FROM NOTAS_FISCAIS;

SELECT * FROM ITENS_NOTAS_FISCAIS;

SELECT 
	YEAR(DATA_VENDA) AS ANO,
	FLOOR(SUM(IMPOSTO * (QUANTIDADE * PRECO))) AS IMPOSTO_TOTAL_2016
FROM 
NOTAS_FISCAIS NF
	INNER JOIN 
ITENS_NOTAS_FISCAIS INF 
	ON NF.NUMERO = INF.NUMERO
WHERE YEAR(DATA_VENDA) = 2016
GROUP BY YEAR(DATA_VENDA);
